# EWallet
Приложение EWallet реализует систему обработки транзакций платёжной системы. 

## Зависимости
- Golang (версия 1.21.3)
- База данных - PostgreSQL

## Установка и запуск проекта
  1) Клонируйте репозиторий.
  ```
  git clone https://github.com/Fluffi1235/EWallet.git
  ```
  2) Заполните информацию о базе данных (измените файл docker-compose.yaml и config.yaml).
     ### Пример:
  ```
  # Пример config.yaml
  connectDb = host=localhost port=5432 user=user password=password dbname=db sslmode=disable

  # Изменение docker-compose.yaml
  POSTGRESQL_USERNAME=user
  POSTGRESQL_PASSWORD=password
  POSTGRESQL_DATABASE=db
  ```
  3) Запустите приложение и БД с помощью команды из корня проекта.
  ```
  docker-compose up -d
  ```
  **Примечание:** Убедитесь, что установлен Docker и Docker Compose на вашем компьютере.
## Важно
  В ТЗ было описано, что баланс кошелька(balance) и сумма перевода(amount) имеют тип float, но тут мы можем столкнуться с проблемой неточности(https://habr.com/ru/articles/338108/).
  Поэтому было принято решение хранить баланс и сумму перевода в виде int(long), но использовать минимальное значение у.е, если считается что 1у.е = 1 рубль, то мы передаем информацию в копейках 1 рубль = 100 копеек.
## Использование
  - Post : `/api/v1/wallet/` - Создание кошелька. Резльтат вернется в виде json-объекта информации о запросе и кошельке - id, balance. 
    ##### Примеры ответа: 
    ```
    №1
    {
    "Info": {
        "status": "Кошелек создан"
      },
    "wallet": {
        "id": "e76eb731c934f89dfca4b2e61e86d4b91de02a8c",
        "balance": 10000
      }
    }
    №2
    {
    "Info": {
        "status": "Кошелек создан"
      },
    "wallet": {
        "id": "fa545151cea8eb34636f7cfd2754ea845830049f",
        "balance": 10000
      }
    }
    ```
  - Post : `/api/v1/wallet/{walletId}/send` - Перевод средств с одного кошелька на другой(walletId - кошелек отправителя). Вместе с запросом передается json-объект в теле запроса("to"- кошелек получателя, "amount" - количество стредств в виде минимальных у.е).
    ##### Пример body: 
    ```
    №1
    {
      "to": "8e22ebfbb8facbb97b6ed8e15cd766e6a00dbe0b",
      "amount": 1000
    }
    ```
    ##### Примеры ответа: 
    ```
    №1
    {
	   "status":"Перевод успешно проведен"
    }
    №2 - Результат работы, если передать невалидный {walletId}
    {
      "status":"Исходящий кошелек не найден"
    }
    №3 - Результат работы, если в теле запроса невалидные данные или на исходном счете недостаточно средств
    {
      "status":"Ошибка в пользовательском запросе или ошибка перевода"
    }
     ```
  - GET : `/api/v1/wallet/{walletId}/history` - Получение историй входящих и исходящих транзакций.
    ##### Примеры ответа: 
    ``` 
    №1
    {
      "Info": {
        "status": "История транзакций получена"
        },
      "history": [
          {
            "time": "2024-01-31T20:16:22Z",
            "from": "e76eb731c934f89dfca4b2e61e86d4b91de02a8c",
            "to": "fa545151cea8eb34636f7cfd2754ea845830049f",
            "amount": 1000
          }
        ]
      }
    №2 - Результат работы, если передать невалидный {walletId}
    {
      "Info": {
        "status": "Указанный кошелек не найден"
        },
      "history": null
    }
    ```
  - GET : `/api/v1/wallet/{walletId}` - Получение текущего состояния кошелька. 
    ##### Примеры ответа: 
    ```
    №1 - Результат работы
    {
      "Info": {
        "status": "OK"
        },
      "wallet": {
          "id": "e76eb731c934f89dfca4b2e61e86d4b91de02a8c",
          "balance": 9000
      }
    }
    №2 - Результат работы, если передать невалидный {walletId}
    {
      "Info": {
        "status": "Указанный кошелек не найден"
        },
      "wallet": null
    }
    ```
